# История изменений

## [1.1.3] - 2025-01-01

### Изменено
- Улучшена обработка административных команд для пользователей без прав администратора:
  - При попытке использовать команды `/alerts`, `/sync` и другие административные команды, пользователи без прав администратора теперь получают информативное сообщение о недоступности этих команд
  - Сообщение содержит список доступных команд для наставников
- Унифицирована реакция на текстовые сообщения для наставников:
  - Авторизованные наставники теперь получают стандартное сообщение "Используйте команды для управления ботом..." при вводе любого текста, не являющегося командой
  - Это обеспечивает единообразное поведение бота для всех авторизованных пользователей

### Добавлено
- Новый обработчик `handle_admin_commands_for_non_admins` для перехвата административных команд от неадминистраторов
- Тестовый скрипт `test_admin_commands.py` для проверки новой функциональности

### Исправлено
- Порядок регистрации обработчиков команд для корректной работы фильтрации административных команд

## [1.1.2] - 2025-06-08

### Исправлено
- Добавлены недостающие зависимости в requirements.txt:
  - gspread==5.12.0
  - google-auth==2.23.4
  - google-auth-oauthlib==1.1.0
  - google-auth-httplib2==0.1.1
- Обновлена логика определения пути к файлу credentials:
  - По умолчанию ищется в `/data` для prod окружения
  - Файл в папке `/data` сохраняется при пересборке проекта

### Изменено
- Улучшена документация по развертыванию на сервере
- Рекомендовано хранить файл credentials в папке `/data`

## [1.1.1] - 2025-06-08

### Изменено
- Улучшена безопасность: путь к файлу сервисного аккаунта Google теперь настраивается через переменную окружения `GOOGLE_CREDENTIALS_PATH`
- ID Google таблицы теперь настраивается через переменную окружения `GOOGLE_SPREADSHEET_ID`
- Обновлена документация: убраны явные названия конфиденциальных файлов
- Расширен .gitignore для игнорирования различных паттернов файлов credentials

### Добавлено
- Новые переменные окружения в env.example:
  - `GOOGLE_CREDENTIALS_PATH` - путь к файлу сервисного аккаунта
  - `GOOGLE_SPREADSHEET_ID` - ID Google таблицы
- Инструкции по получению сервисного аккаунта Google Cloud в документации

## [1.1.0] - 2025-06-08

### Добавлено
- Функция синхронизации БД с Google Sheets
  - Автоматическая синхронизация по расписанию через `SYNC_INTERVAL_MINUTES`
  - Ручная синхронизация через команду `/sync`
  - История синхронизаций в таблице `sync_history`
  - Статус и настройки синхронизации
- Новая таблица `sync_history` для хранения истории синхронизаций
- Команда `/sync` для администраторов с подкомандами:
  - Синхронизировать сейчас
  - Статус синхронизации
  - Настройки
- Тестовый скрипт `test_sync.py`
- Документация по использованию синхронизации `SYNC_USAGE.md`

### Изменено
- Обновлены информационные сообщения в командах `/start`, `/help`, `/about`
- Версия бота обновлена до 1.1.0

### Удалено
- Команды `/stats` и `/broadcast` (не были реализованы)
- Упоминания о нереализованных функциях в документации

### Исправлено
- Проблема с инициализацией `async_engine` при запуске синхронизации
- Ошибка использования `async_session` в тестах

## [1.0.0] - 2025-06-01

### Начальная версия
- Базовая функциональность бота
- Авторизация наставников по email
- Получение уведомлений о действиях студентов
- Система алертов для администраторов
- Команды: `/start`, `/help`, `/about`, `/status`, `/alerts`