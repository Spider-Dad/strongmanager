# üìã –†–µ–∑—é–º–µ –§–∞–∑—ã 3: –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

**–î–∞—Ç–∞:** 2025-12-21
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í–°–ï –ó–ê–î–ê–ß–ò –í–´–ü–û–õ–ù–ï–ù–´

---

## –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### Python-—Å–µ—Ä–≤–∏—Å—ã (5 —Ñ–∞–π–ª–æ–≤)

1. ‚úÖ **`bot/services/notification_calculator.py`** (214 —Å—Ç—Ä–æ–∫)
   - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π (–æ—Ç–≤–µ—Ç—ã, –¥–µ–¥–ª–∞–π–Ω—ã, –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω (UTC ‚Üí Moscow)

2. ‚úÖ **`bot/services/webhook_processor.py`** (292 —Å—Ç—Ä–æ–∫–∏)
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–µ–±—Ö—É–∫–æ–≤ –∏–∑ `webhook_events`
   - –ü–æ–∏—Å–∫ –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–æ–≤ —á–µ—Ä–µ–∑ `mapping`
   - –°–æ–∑–¥–∞–Ω–∏–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
   - –ú–∏–≥—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –∏–∑ `lessonHandlers.gs`

3. ‚úÖ **`bot/services/deadline_checker.py`** (332 —Å—Ç—Ä–æ–∫–∏)
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–±–ª–∏–∂–∞—é—â–∏—Ö—Å—è –¥–µ–¥–ª–∞–π–Ω–æ–≤ (36 —á–∞—Å–æ–≤)
   - –ü–æ–∏—Å–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ –±–µ–∑ –æ—Ç–≤–µ—Ç–æ–≤
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–∞–º
   - –ú–∏–≥—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –∏–∑ `deadlineHandlers.gs`

4. ‚úÖ **`bot/services/reminder_service.py`** (287 —Å—Ç—Ä–æ–∫)
   - –ê–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–æ–≤ –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –¥–∞—Ç—É (2 –¥–Ω—è –Ω–∞–∑–∞–¥)
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–∞–º
   - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
   - –ú–∏–≥—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –∏–∑ `reminderHandlers.gs`

5. ‚úÖ **`bot/services/notification_sender.py`** (177 —Å—Ç—Ä–æ–∫)
   - –û—Ç–ø—Ä–∞–≤–∫–∞ pending —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Telegram
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–≥–æ telegram_id
   - Retry —Å exponential backoff
   - –ë–∞—Ç—á–∏–Ω–≥ (20 —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –∑–∞ —Ä–∞–∑)

### –¢–µ—Å—Ç—ã (6 —Ñ–∞–π–ª–æ–≤)

6. ‚úÖ **`tests/test_notification_calculator.py`**
   - –¢–µ—Å—Ç—ã —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π
   - –¢–µ—Å—Ç –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∑–æ–Ω

7. ‚úÖ **`tests/test_webhook_processor.py`**
   - –¢–µ—Å—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ –Ω–æ–≤–æ–º –æ—Ç–≤–µ—Ç–µ
   - Placeholder –¥–ª—è —Ç–µ—Å—Ç–∞ –ø–æ–∏—Å–∫–∞ –Ω–∞—Å—Ç–∞–≤–Ω–∏–∫–∞

8. ‚úÖ **`tests/test_deadline_checker.py`**
   - –¢–µ—Å—Ç —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è –æ –¥–µ–¥–ª–∞–π–Ω–µ
   - –¢–µ—Å—Ç –ª–æ–≥–∏–∫–∏ —Ä–∞—Å—á–µ—Ç–∞ –ø—Ä–∏–±–ª–∏–∂–∞—é—â–∏—Ö—Å—è –¥–µ–¥–ª–∞–π–Ω–æ–≤

9. ‚úÖ **`tests/test_phase3_integration.py`**
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç (pytest)
   - –¢—Ä–µ–±—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–π –ë–î PostgreSQL

10. ‚úÖ **`tests/test_timezone_verification.py`**
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ PostgreSQL
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ Python
    - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–∏–∫–∏ –¥–µ–¥–ª–∞–π–Ω–æ–≤

11. ‚úÖ **`tests/test_manual_full_cycle.py`**
    - –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    - –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª: –≤–µ–±—Ö—É–∫ ‚Üí –æ–±—Ä–∞–±–æ—Ç–∫–∞ ‚Üí —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    - Cleanup —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (5 —Ñ–∞–π–ª–æ–≤)

12. ‚úÖ **`wiki/REFACTORING_PHASE3.md`**
    - –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –§–∞–∑—ã 3
    - –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
    - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∑–∞–ø—É—Å–∫—É
    - –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

13. ‚úÖ **`wiki/PHASE3_COMPLETE.md`**
    - –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ
    - –ß–µ–∫–ª–∏—Å—Ç –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
    - –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

14. ‚úÖ **`wiki/PHASE3_TESTING_GUIDE.md`**
    - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
    - –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏
    - Troubleshooting

15. ‚úÖ **`wiki/REFACTORING_COMPLETE.md`**
    - –ò—Ç–æ–≥–∏ –≤—Å–µ—Ö 3 —Ñ–∞–∑
    - –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –¥–æ/–ø–æ—Å–ª–µ
    - –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç

16. ‚úÖ **`QUICK_START_PHASE3.md`**
    - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    - –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
    - Troubleshooting

---

## –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ö–æ–¥ (6 —Ñ–∞–π–ª–æ–≤)

17. ‚úÖ **`bot/handlers/auth.py`**
    - ‚ùå –£–¥–∞–ª–µ–Ω—ã: `get_mentor_by_email`, `register_telegram_id`, `ApiError`
    - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞: –ø—Ä—è–º–∞—è —Ä–∞–±–æ—Ç–∞ —Å PostgreSQL
    - ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–µ–Ω—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ `valid_to`

18. ‚úÖ **`main.py`**
    - ‚ùå –£–¥–∞–ª–µ–Ω–∞: –∑–∞–¥–∞—á–∞ `check_new_notifications` (GAS API)
    - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã: 4 –Ω–æ–≤—ã–µ –∑–∞–¥–∞—á–∏ APScheduler
    - ‚úÖ –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è 4 –Ω–æ–≤—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

19. ‚úÖ **`bot/config.py`**
    - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: 8 –Ω–æ–≤—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
    - –ò–Ω—Ç–µ—Ä–≤–∞–ª—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏ (webhook, deadline, notification)
    - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–µ–¥–ª–∞–π–Ω–æ–≤ –∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏–π
    - –†–∞–∑–º–µ—Ä—ã –±–∞—Ç—á–µ–π

20. ‚úÖ **`env.example`**
    - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: 8 –Ω–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
    - –° –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è–º–∏ –∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

21. ‚úÖ **`requirements.txt`**
    - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: `pytz==2024.1`

22. ‚úÖ **`README.md`**
    - ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ: –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
    - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞: —Å—Ö–µ–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
    - ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∞: –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

23. ‚úÖ **`getcourse_apps_script/README.md`**
    - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: –ø–æ–º–µ—Ç–∫–∞ "ARCHIVED"
    - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
    - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: —Å–∫—Ä–∏–ø—Ç –æ—Ç–∫–ª—é—á–µ–Ω–∏—è —Ç—Ä–∏–≥–≥–µ—Ä–æ–≤
    - ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ: –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∞—Ä—Ö–∏–≤–∞—Ü–∏–∏

---

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

### –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –∫–æ–¥–∞

| –§–∞–π–ª | –°—Ç—Ä–æ–∫ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|------|-------|------------|
| notification_calculator.py | 214 | –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ–¥—É–ø–ª–∏–∫–∞—Ü–∏—è |
| webhook_processor.py | 292 | –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–µ–±—Ö—É–∫–æ–≤ |
| deadline_checker.py | 332 | –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–¥–ª–∞–π–Ω–æ–≤ |
| reminder_service.py | 287 | –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è |
| notification_sender.py | 177 | –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram |
| **–ò–¢–û–ì–û —Å–µ—Ä–≤–∏—Å–æ–≤** | **1302** | **5 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤** |

### –¢–µ—Å—Ç—ã –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –§–∞–π–ª–æ–≤ | –°—Ç—Ä–æ–∫ |
|-----------|--------|-------|
| Unit-—Ç–µ—Å—Ç—ã | 3 | ~450 |
| –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã | 3 | ~500 |
| –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è | 5 | ~1500 |
| **–ò–¢–û–ì–û** | **11** | **~2450** |

---

## –ú–∏–≥—Ä–∞—Ü–∏—è –ª–æ–≥–∏–∫–∏ –∏–∑ GAS

### –ß—Ç–æ –±—ã–ª–æ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ

| GAS —Ñ—É–Ω–∫—Ü–∏—è | Python —Å–µ—Ä–≤–∏—Å | –°—Ç–∞—Ç—É—Å |
|-------------|---------------|--------|
| `processAnswerToLesson()` | `WebhookProcessingService.process_answer_to_lesson()` | ‚úÖ |
| `checkApproachingDeadlines()` | `DeadlineCheckService.check_deadlines()` | ‚úÖ |
| `processReminderNotifications()` | `ReminderService.process_reminder_notifications()` | ‚úÖ |
| `register_telegram_id()` | `auth.py` (–ø—Ä—è–º–æ–π PostgreSQL) | ‚úÖ |
| `check_new_notifications()` | `NotificationSenderService.send_pending_notifications()` | ‚úÖ |

### –ß—Ç–æ –ù–ï –±—ã–ª–æ –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–æ

| GAS —Ñ—É–Ω–∫—Ü–∏—è | –ü—Ä–∏—á–∏–Ω–∞ |
|-------------|---------|
| `processCommentOnLesson()` | –û—Ç–∫–ª—é—á–µ–Ω–æ –≤ GAS (`ENABLE_COMMENT_NOTIFICATIONS=false`) |
| Google Sheets —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è | –ó–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ –ø—Ä—è–º—É—é —Ä–∞–±–æ—Ç—É —Å PostgreSQL |

---

## –£–¥–∞–ª–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç GAS

### –ò–º–ø–æ—Ä—Ç—ã (—É–¥–∞–ª–µ–Ω—ã)

```python
# ‚ùå –ë–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è:
from bot.services.api import get_mentor_by_email
from bot.services.api import register_telegram_id
from bot.services.api import get_new_notifications
from bot.services.api import update_notification_status
from bot.services.api import ApiError
```

### –§—É–Ω–∫—Ü–∏–∏ (—É–¥–∞–ª–µ–Ω—ã/–∑–∞–º–µ–Ω–µ–Ω—ã)

```python
# ‚ùå bot/services/notifications.py
check_new_notifications()  # –ó–∞–º–µ–Ω–µ–Ω–∞ –Ω–∞ NotificationSenderService

# ‚ùå bot/services/api.py
# –í–µ—Å—å —Ñ–∞–π–ª –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –∏–ª–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –≤ api_deprecated.py)
```

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ —É–¥–∞–ª–∏—Ç—å)

```python
# bot/config.py
self.api_url  # GAS API URL - –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
```

---

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—Ä–∞–±–æ—Ç–∫–∏

### APScheduler –∑–∞–¥–∞—á–∏

| –ó–∞–¥–∞—á–∞ | –ò–Ω—Ç–µ—Ä–≤–∞–ª | –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|--------|----------|---------------------|--------------|
| –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤–µ–±—Ö—É–∫–æ–≤ | seconds | WEBHOOK_PROCESSING_INTERVAL | 30 —Å–µ–∫ |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–¥–ª–∞–π–Ω–æ–≤ | minutes | DEADLINE_CHECK_INTERVAL_MINUTES | 60 –º–∏–Ω |
| –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π | seconds | NOTIFICATION_SEND_INTERVAL | 15 —Å–µ–∫ |
| –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è | cron (daily) | REMINDER_TRIGGER_HOUR | 12:00 MSK |

### –ë–∞—Ç—á–∏–Ω–≥

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----------|--------------|----------|
| –í–µ–±—Ö—É–∫–∏ | WEBHOOK_BATCH_SIZE | 50 | –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞ —Ä–∞–∑ |
| –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è | NOTIFICATION_BATCH_SIZE | 20 | –û—Ç–ø—Ä–∞–≤–∫–∞ –∑–∞ —Ä–∞–∑ |

### –î–µ–¥–ª–∞–π–Ω—ã

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----------|--------------|----------|
| –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ | DEADLINE_WARNING_HOURS | 36 | –ß–∞—Å–æ–≤ –¥–æ –¥–µ–¥–ª–∞–π–Ω–∞ |

### –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------|-----------|--------------|----------|
| –ß–∞—Å –∑–∞–ø—É—Å–∫–∞ | REMINDER_TRIGGER_HOUR | 12 | 12:00 MSK |
| –î–Ω–µ–π –Ω–∞–∑–∞–¥ | REMINDER_ANALYSIS_DAYS_BACK | 2 | –ê–Ω–∞–ª–∏–∑ –æ—Ç–≤–µ—Ç–æ–≤ |

---

## –°–ª–µ–¥—É—é—â–∏–µ –¥–µ–π—Å—Ç–≤–∏—è

### 1. –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```powershell
# 1. –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–æ–Ω—ã
python tests/test_timezone_verification.py

# 2. Unit-—Ç–µ—Å—Ç—ã
python tests/test_notification_calculator.py

# 3. –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª
python tests/test_manual_full_cycle.py
```

### 2. –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–ß–µ—Ä–µ–∑ DBeaver:**
- –ó–∞–ø–æ–ª–Ω–∏—Ç—å `mentors` (telegram_id = NULL –¥–ª—è –Ω–æ–≤—ã—Ö)
- –ó–∞–ø–æ–ª–Ω–∏—Ç—å `students`
- –ó–∞–ø–æ–ª–Ω–∏—Ç—å `trainings`
- –ó–∞–ø–æ–ª–Ω–∏—Ç—å `lessons` (—Å deadline_date)
- –ó–∞–ø–æ–ª–Ω–∏—Ç—å `mapping`

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ .env –Ω–∞ Amvera

–î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ –Ω–æ–≤—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ `env.example`

### 4. Deploy

```powershell
# –°–ª–∏—Ç—å –≤ main –∏ push
git checkout main
git merge refactoring
git push origin main
```

### 5. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–ü–µ—Ä–≤—ã–µ 24 —á–∞—Å–∞ - –∞–∫—Ç–∏–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ –∏ PostgreSQL

### 6. –ê—Ä—Ö–∏–≤–∞—Ü–∏—è GAS

–ü–æ—Å–ª–µ 48 —á–∞—Å–æ–≤ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã - –æ—Ç–∫–ª—é—á–∏—Ç—å —Ç—Ä–∏–≥–≥–µ—Ä—ã –∏ –∑–∞–∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã

**–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:** Pavel Shvydkin
**Telegram:** @spiderdad

**–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
- –ü–æ–ª–Ω–∞—è: `wiki/REFACTORING_PHASE3.md`
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ: `wiki/PHASE3_TESTING_GUIDE.md`
- –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: `QUICK_START_PHASE3.md`
- –§–∏–Ω–∞–ª—å–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç: `wiki/REFACTORING_COMPLETE.md`

---

‚úÖ **–§–∞–∑–∞ 3 –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é!**
‚úÖ **–ì–æ—Ç–æ–≤–æ –∫ –ª–æ–∫–∞–ª—å–Ω–æ–º—É —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!**
‚úÖ **–ì–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é –ø–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö!**
