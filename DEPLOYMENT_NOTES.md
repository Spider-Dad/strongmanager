# Заметки по развертыванию

## Важные файлы, которые НЕ включены в репозиторий

### 1. Файл сервисного аккаунта Google Cloud
Для работы синхронизации с Google Sheets необходим файл с ключами сервисного аккаунта.

**Как получить:**
1. Создайте проект в [Google Cloud Console](https://console.cloud.google.com/)
2. Включите Google Sheets API
3. Создайте сервисный аккаунт
4. Сгенерируйте JSON-ключ для сервисного аккаунта
5. Предоставьте доступ сервисному аккаунту к вашей Google таблице

**Размещение:**
- Скопируйте файл на сервер в безопасное место
- Укажите путь к файлу в переменной окружения `GOOGLE_CREDENTIALS_PATH`
- По умолчанию бот ищет файл `google_credentials.json` в корневой директории

**Важно:** Никогда не коммитьте файл с ключами в репозиторий!

### 2. Файл переменных окружения
**Файл:** `.env`

Создайте файл на основе `env.example` и заполните необходимые значения:
```
BOT_TOKEN=your_bot_token_here
API_URL=https://script.google.com/macros/s/your_script_id/exec
ADMIN_IDS=123456789,987654321
POLLING_INTERVAL=15
SERVER_ENV=prod
SYNC_INTERVAL_MINUTES=60
GOOGLE_CREDENTIALS_PATH=path/to/your/credentials.json
GOOGLE_SPREADSHEET_ID=your_spreadsheet_id_here
```

## Устаревшие файлы

### import_gsheets_to_sqlite.py
**Статус:** УСТАРЕЛ, НЕ НУЖЕН

Этот файл был заменен на `bot/services/sync_service.py`. Вся функциональность синхронизации теперь интегрирована в бота.

**При развертывании:**
- НЕ копируйте этот файл на сервер
- Используйте команду `/sync` в боте для ручной синхронизации
- Или настройте автоматическую синхронизацию через `SYNC_INTERVAL_MINUTES`

## Процесс развертывания

1. Клонируйте репозиторий
2. Создайте файл `.env` на основе `env.example`
3. Получите и разместите файл сервисного аккаунта Google Cloud
4. Установите зависимости: `pip install -r requirements.txt`
5. Запустите бота: `python main.py`

## Синхронизация БД на новом сервере

При первом запуске на новом сервере:
1. Запустите бота
2. Используйте команду `/sync` от имени администратора
3. Или дождитесь автоматической синхронизации (если настроена)